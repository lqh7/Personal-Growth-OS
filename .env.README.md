# 环境配置文件说明

## 配置文件结构

本项目使用两个配置文件：

### 1. `.env.example` (项目根目录) - 配置模板

**用途**:
- 📝 提供完整的配置示例和文档
- 🔧 展示所有可用的配置选项
- 📚 帮助新用户了解如何配置项目

**特点**:
- 包含占位符 API Key (如 `your_openai_api_key_here`)
- 包含所有高级配置项（数据库、向量存储、嵌入模型等）
- 包含详细注释
- **提交到 Git 版本控制**

**包含的配置项**:
- LLM 配置 (OpenAI, Claude, Ollama)
- 数据库配置 (`DATABASE_URL`)
- ChromaDB 配置 (`CHROMA_PERSIST_DIRECTORY`)
- Mem0 配置 (`MEM0_PERSIST_DIRECTORY`)
- 嵌入模型配置 (`EMBEDDING_MODEL`)
- CORS 配置等

### 2. `backend/.env` - 实际配置文件

**用途**:
- ✅ **后端 FastAPI 服务实际读取的配置**
- 💾 **前端设置页面保存配置的目标文件**
- 🔐 **存储真实的 API Key 和敏感信息**

**特点**:
- 包含真实的 API Key
- 由前端设置页面自动生成和更新
- 只包含 LLM 相关配置（精简版）
- **不提交到 Git（被 .gitignore 忽略）**

**包含的配置项**:
- LLM Provider 选择
- OpenAI 配置 (API Key, Base URL, Model)
- Anthropic/Claude 配置 (API Key, Base URL, Model)
- Ollama 配置 (Base URL, Model)
- Temperature 参数

## 初次配置步骤

### 方法1: 使用前端设置页面（推荐）✅

1. 启动后端服务: `cd backend && python -m uvicorn app.main:app --reload`
2. 启动前端服务: `cd frontend && npm run dev`
3. 访问 http://localhost:5173
4. 进入"设置"页面
5. 配置你的 LLM Provider 和 API Key
6. 点击"保存配置"按钮
7. 配置会自动保存到 `backend/.env` 并立即生效

### 方法2: 手动创建配置文件

如果需要配置高级选项（如数据库路径、向量存储等）：

1. 复制模板文件:
   ```bash
   cp .env.example backend/.env
   ```

2. 编辑 `backend/.env`，填入真实的配置:
   ```bash
   # 修改 API Key
   OPENAI_API_KEY=sk-your-actual-api-key-here

   # 选择 LLM Provider
   LLM_PROVIDER=openai  # 或 claude, ollama
   ```

3. 重启后端服务使配置生效

## 配置更新

### 修改 LLM 配置
- 使用前端设置页面修改（推荐）
- 修改会自动保存到 `backend/.env`
- 无需重启服务即可生效（Hot Reload）

### 修改高级配置
- 手动编辑 `backend/.env`
- 需要重启后端服务

## 安全提示

⚠️ **重要**:
- 不要将 `backend/.env` 提交到 Git 仓库
- 不要在公开场合分享 API Key
- `.env.example` 只能包含占位符，不能包含真实的 API Key

## 故障排查

### 配置不生效？

1. 确认你修改的是 `backend/.env`，不是根目录的 `.env.example`
2. 检查文件路径是否正确
3. 查看后端日志，确认配置已加载
4. 如果手动修改了文件，重启后端服务

### 前端设置页面保存失败？

1. 检查后端服务是否正常运行 (http://localhost:8000)
2. 查看浏览器控制台是否有错误信息
3. 查看后端日志是否有 `[SettingsService] .env file updated successfully`

## 文件位置总结

```
Personal-Growth-OS/
├── .env.example           ← 配置模板（提交到 Git）
├── backend/
│   └── .env              ← 实际配置（不提交到 Git）
└── .gitignore            ← 确保 .env 被忽略
```
